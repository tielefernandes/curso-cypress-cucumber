# Fork e clone do projeto 🐑

1. Abra o navegador e visite a URL <https://github.com/wlsf82/curso-cypress-cucumber>.
2. Faça um [fork]((https://docs.github.com/pt/pull-requests/collaborating-with-pull-requests/working-with-forks/fork-a-repo)) do projeto.

> 👨‍🏫 É importante que você trabalhe em seu fork, para que ao final do curso, você possa executar os testes em um _workflow_ de integração contínua.

3. Em seu fork, clique no botão **Code**, escolha a opção _clone via SSH_ e copie o link de clone do projeto.

> Para obter detalhes sobre como clonar um projeto do GitHub, leia a [documentação oficial](https://docs.github.com/pt/repositories/creating-and-managing-repositories/cloning-a-repository).
>
> Para obter detalhes sobre como criar e configurar uma chave SSH no GitHub, leia a [documentação oficial](https://docs.github.com/pt/authentication/connecting-to-github-with-ssh/about-ssh).

4. Em seu terminal de linha de comando (em uma pasta onde você armazena seus projetos de software), execute o comando `git clone [cole-o-link-copiado-aqui]`.

> 👨‍🏫 Para garantir que você está clonando o seu fork, verifique seu nome de usuário do GitHub na URL de clone do projeto. Deve ser semelhante a `git@github.com:[seu-nome-de-usuário-aqui]/curso-cypress-cucumber.git`.

5. Após clonar o projeto, acesse o diretório recém-clonado (`cd curso-cypress-cucumber/`).

> **Obs.:** Dentro do diretório `curso-cypress-cucumber/`, você deve ter os subdiretórios `.git/` (diretório oculto) e `lessons/`, e os arquivos `.gitignore` (arquivo oculto), `LICENSE`, `package.json` e `README.md`.

## Instalação e inicialização do [Cypress](https://cypress.io) 🌲

1. Na raiz do projeto, execute o comando `npm install cypress@15.3.0 --save-dev` (ou `npm i cypress@15.3.0 -D` para a versão curta).
2. Execute o comando `npx cypress open` para abrir o Cypress pela primeira vez e deixe-o guiá-lo na criação de uma suite de testes de ponta a ponta (E2E).
3. Através da _Cypress App_, crie um teste padrão, só para testar que tudo está funcionando (depois de testar, pode deletar o arquivo `cypress/e2e/spec.cy.js`).
4. Por fim, delete a pasta `cypress/fixtures/` visto que não a utilizaremos durante o curso.

> 👨‍🏫 Em seguida, iremos configurar o Cypress para ignorar a pasta `cypress/fixtures/`.

> **Obs. 2:** Quando iniciado pela primeira vez, o Cypress cria automaticamente o arquivo `cypress.config.js` e o diretório `cypress/`, com os subdiretórios `e2e/`, `fixtures/` e `support/`, com seus respectivos arquivos.
>
> 👨‍🏫 É importante instalar a exata versão do Cypress descrita acima (`15.3.0`) para não ter problemas de incompatibilidade.
>
> Para aprender mais sobre o Cypress, confira sua [documentação oficial](https://docs.cypress.io/).

## Instalação e configuração do plugin do Cucumber para Cypress. 🥒

1. Na raiz do projeto, execute o comando `npm install @badeball/cypress-cucumber-preprocessor@23.0.0 @bahmutov/cypress-esbuild-preprocessor@2.2.5 --save-dev` (ou `npm i  @badeball/cypress-cucumber-preprocessor@23.0.0 @bahmutov/cypress-esbuild-preprocessor@2.2.5 -D` para a versão curta).
2. Após a instalação desses pacotes, você precisa configurar o Cypress para usar os plugins. Portanto, copie e cole o código abaixo em seu arquivo `cypress.config.js`.

```js
import { defineConfig } from 'cypress'
import createBundler from '@bahmutov/cypress-esbuild-preprocessor'
import { addCucumberPreprocessorPlugin } from '@badeball/cypress-cucumber-preprocessor'
import createEsbuildPlugin from '@badeball/cypress-cucumber-preprocessor/esbuild'

export default defineConfig({
  e2e: {
    fixturesFolder: false,
    specPattern: 'cypress/e2e/**/*.feature',
    async setupNodeEvents(on, config) {
      await addCucumberPreprocessorPlugin(on, config)
      on('file:preprocessor', createBundler({
        plugins: [createEsbuildPlugin(config)],
      }))

      return config
    },
  },
})

```

> 👨‍🏫 O atributo `specPattern` informa ao Cypress que queremos procurar por arquivos `.feature` na pasta `e2e/`. Isso significa que ele ignorará todos os outros formatos e usará apenas arquivos `.feature` como testes.
>
> A função `addCucumberPreprocessorPlugin()` se encarrega de processar esses arquivos `.feature` e convertê-los para Javascript. Como o Cypress roda no navegador, precisamos garantir que tudo o que executamos (sejam arquivos .ts, .jsx ou outros formatos) seja eventualmente compilado em Javascript puro. É isso que os pré-processadores fazem.
>
> O `on("file:preprocessor")` se encarrega de combinar o plugin `esbuild` com o plugin `cucumber` para que funcionem juntos.
>
> A instrução de configuração `return` final garante que tudo o que configuramos será realmente definido em nossa configuração. Esta etapa é frequentemente esquecida, portanto, se seus plugins se comportarem como se não estivessem instalados, verifique a instrução `return`.

## _npm scripts_

Por fim, atualize a seção de scripts do arquivo `package.json` conforme abaixo.

```json
"scripts": {
  "cy:open": "cypress open",
  "test": "cypress run"
},
```

> 👨‍🏫 O primeiro script abre a _Cypress App_ para execução dos testes em modo interativo, e o segundo, executa todos os testes em modo _headless_.

___

Parabéns! [Vamos para a aula 1 escrever nosso primeiro arquivo de _feature_](./1.md).

___

[Voltar para a página inicial](../README.md)
