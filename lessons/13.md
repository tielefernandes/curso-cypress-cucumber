# Solu√ß√£o simplificada sem Cucumber ü™Ñ

[Neste outro projeto no GitHub](https://github.com/wlsf82/cucumber-salad/tree/simplified-version-without-cucumber), no _branch_ [`simplified-version-without-cucumber`](https://github.com/wlsf82/cucumber-salad/tree/simplified-version-without-cucumber), demonstro os mesmos cen√°rios de teste implementados durante o curso, por√©m, usando a sintaxe padr√£o do Cypress em vez do Cucumber com _Gherkin_.

Os testes mant√™m a mesma funcionalidade e cobertura, mas s√£o escritos no formato tradicional do Cypress.

## Principais diferen√ßas

Abaixo listo as principais diferen√ßas do projeto sem Cucumber.

### Estrutura dos testes

- Os testes usam os blocos `describe()` e `it()` em vez dos arquivos de _feature_ do _Gherkin_
- Os _step definitions_ s√£o substitu√≠dos por comandos nativos do Cypress direto nos arquivos `*.cy.js`
- Os coment√°rios no c√≥digo dos testes fazem refer√™ncia √† estrutura original "Given/When/Then"

### Configura√ß√£o

- N√£o √© necess√°ria a configura√ß√£o do pr√©-processador do Cucumber
- O arquivo `cypress.config.js` √© mais simples, apenas com o `@cypress/grep` para filtragem por _tags_
- Depend√™ncias reduzidas (apenas `cypress` e `@cypress/grep`)

### Organiza√ß√£o dos testes

- Mesma estrutura de pastas da vers√£o com Cucumber (com exce√ß√£o da pasta `cypress/support/step_definitions/`)
- Os testes s√£o organizados por aplica√ß√£o (EngageSphere/HackerStories) e funcionalidades
- As _tags_ ainda s√£o usadas para categoriza√ß√£o de testes (`@smoke`, `@engagesphere` e `@hackerstories`)

## Compara√ß√£o dos testes

Vejamos um exemplo - **antes** (com Cucumber) - e **depois** (somente com comandos nativos de Cypress).

### Vers√£o com Cucumber (_Gherkin_)

```feature
# cypress/e2e/engagesphere/greeting.feature

  @engagesphere
  Scenario: shows a customized greeting
    Given I access the EngageSphare app having already accepted the cookies banner
    When I type "<name>" in the name input field
    Then I see the following greeting: Hi "<name>"!
```

### Vers√£o simplificada (comandos nativos do Cypress)

```js
// cypress/e2e/engagesphere/greeting.cy.js

it(`shows a customized greeting: Hi ${name}!`, { tags: '@engagesphere' }, () => {
  // Given I access the EngageSphare app having already accepted the cookies banner
  cy.setCookie('cookieConsent', 'accepted')
  cy.visit('https://engage-sphere.vercel.app/')
  // When I type "<name>" in the name input field
  cy.get('input[data-testid="name"]').type(name)
  // Then I see the following greeting: Hi "<name>"!
  cy.contains('h2', `Hi ${name}!`).should('be.visible')
})
```

## Testes orientados √† dados

Vejamos outro exemplo - **antes** (com Cucumber) - e **depois** (somente com comandos nativos de Cypress).

### Vers√£o com Cucumber - Testes orientados √† dados (_Gherkin_)

```feature
# cypress/e2e/engagesphere/itemsPerPage.feature

Feature: Items per page

  Background: access EngageSphere with the cookies consent banner already accepted
    Given I access the EngageSphare app having already accepted the cookies banner

  @engagesphere
  Scenario: shows the correct number per page
    When I filter by "<number>" items per page
    Then I see "<number>" table rows

    Examples:
      | number |
      | 5      |
      | 10     |
      | 20     |
      | 50     |
```

### Vers√£o simplificada - Testes orientados √† dados (comandos nativos do Cypress)

A vers√£o simplificada implementa testes orientados √† dados usando _arrays_ JavaScript e _loops_ `forEach()`.

```js
// cypress/e2e/engagesphere/itemsPerPage.cy.js

describe('Items per page', { tags: '@engagesphere' }, () => {
  beforeEach(() => {
    // Given I access the EngageSphare app having already accepted the cookies banner
    cy.setCookie('cookieConsent', 'accepted')
    cy.visit('https://engage-sphere.vercel.app/')
  })

  // Examples
  const numbers = ['5', '10', '20', '50']

  numbers.forEach((numbers, index) => {
    it(`shows the correct number per page (Example: ${index + 1})`, () => {
      // When I filter by "<number>" items per page
      cy.get('[aria-label="Pagination limit"]').select(numbers)
      // Then I see "<number>" table rows
      cy.get('tbody tr').should('have.length', numbers)
    })
  })
})
```

## Benef√≠cios dessa abordagem

- **Configura√ß√£o mais simples:** N√£o requer configura√ß√£o adicional de pr√©-processador
- **Sintaxe familiar:** Utiliza a sintaxe padr√£o Cypress/Mocha/Chai, conhecida pela maioria dos/das desenvolvedores/as e testadores/as
- **Melhor suporte a IDE:** Suporte completo a _IntelliSense_ e depura√ß√£o
- **Manuten√ß√£o mais f√°cil:** C√≥digo de teste direto-ao-ponto sem camada de tradu√ß√£o (sem a necessidade de _step definitions_)
- **Execu√ß√£o mais r√°pida:** N√£o √© necess√°rio pr√©-processamento de arquivos _Gherkin_
- **Mais conciso:** Esta vers√£o possui 59 linhas de c√≥digo a menos e 7 arquivos a menos em compara√ß√£o com a implementa√ß√£o com Cucumber.
- **Menos depend√™ncias:** O arquivo `package-lock.json` tem 4754 linhas de c√≥digo a menos em compara√ß√£o com a implementa√ß√£o com Cucumber.

## Executando os testes simplificados

Os scripts do npm funcionam da mesma maneira:

```bash
npm test                   # Executa todos os testes
npm run test:smoke         # Executa apenas os _smoke tests_
npm run test:not:smoke     # Executa apenas _not smoke tests_
npm run test:engagesphere  # Executa os testes da aplica√ß√£o EngageSphere
npm run test:hackerstories # Executa os testes da aplica√ß√£o Hacker Stories
```

A filtragem por _tags_ ainda funciona, usando o plugin `@cypress/grep`, mantendo os mesmos recursos de organiza√ß√£o de testes da vers√£o com Cucumber.

___

> üë®‚Äçüè´Agora que voc√™ aprendeu a usar Cypress com Cucumber e tamb√©m viu como pode ser mais f√°cil obter os mesmos resultados sem ele, a escolha de usar (ou n√£o) √© sua.
>
> Eu, pessoalmente, n√£o uso.

[Vamos para a pr√≥xima aula, onde vou te apresentar outras iniciativas da Talking About Testing](./services-tat.md).

___

[Voltar para a p√°gina inicial](../README.md)
